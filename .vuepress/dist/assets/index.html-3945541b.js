import{_ as t,o as p,c as e,d as s,f as a,b as n}from"./app-ab9ebd95.js";const o={},c=a(`<h2 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a> å‰è¨€</h2><blockquote><p>åœ¨Webå¼€å‘çš„å¤§æµ·ä¸­ï¼Œæˆ‘ä»¬æ—¶å¸¸éœ€è¦åœ¨ä¸åŒæºçš„ç½‘é¡µä¹‹é—´ä¼ é€’æ•°æ®ã€‚<br> è¿™å°±åƒæ˜¯ä¸€åœºå……æ»¡æŒ‘æˆ˜çš„è·¨åŸŸæ¼‚æµï¼Œè€ŒåŒæºç­–ç•¥å°±åƒæ˜¯ä¸€è‰˜èˆ¹ï¼Œåšå®šåœ°æ‹’ç»ç€ä»»ä½•æœªç»å…è®¸çš„å…¥ä¾µã€‚<br> ä¸ºäº†ç»•å¼€è¿™ä¸ª&quot;åŒæº&quot;çš„å¤§é—¨å«ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå€ŸåŠ©ä¸€å¯¹é»˜å¥‘çš„æ­æ¡£ï¼šiframe å’Œ postMessageã€‚<br> è¿™æ˜¯ä¸€åœºéåŒæºä¼ é€’æ•°æ®çš„ç‹‚æ¬¢æ´¾å¯¹ï¼Œä»Šå¤©æˆ‘ä»¬å°±è¦æ­å¼€è¿™å¯¹æ­æ¡£çš„ç¥ç§˜é¢çº±ï¼Œä¸€æ¢ç©¶ç«Ÿï¼ğŸ˜</p></blockquote><h2 id="_1ã€iframe-å’Œ-postmessage-çš„æµªæ¼«é‚‚é€…" tabindex="-1"><a class="header-anchor" href="#_1ã€iframe-å’Œ-postmessage-çš„æµªæ¼«é‚‚é€…" aria-hidden="true">#</a> 1ã€iframe å’Œ postMessage çš„æµªæ¼«é‚‚é€…</h2><p>åœ¨æˆ‘ä»¬çš„ä¼ å¥‡æ•…äº‹ä¸­ï¼Œiframeå’ŒpostMessageå°±åƒæ˜¯ä¸¤ä½ä¸åŒæºçš„ç›¸äº²å¯¹è±¡ï¼Œé€šè¿‡ä¸€åœºæµªæ¼«çš„é‚‚é€…æ‰¾åˆ°äº†å½¼æ­¤çš„é»˜å¥‘ã€‚</p><h3 id="_1-1-è®¤è¯†-iframe" tabindex="-1"><a class="header-anchor" href="#_1-1-è®¤è¯†-iframe" aria-hidden="true">#</a> 1.1 è®¤è¯† iframe</h3><p>iframeæ˜¯HTMLä¸­çš„ä¸€ä½&quot;ç²¾çµ&quot;ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç½‘é¡µä¸­åµŒå¥—å¦ä¸€ä¸ªç½‘é¡µã€‚å°±åƒæ˜¯æŠŠä¸€ä¸ªå°çª—å£åµŒå…¥åˆ°å¤§çª—å£ä¸€æ ·ï¼Œè¿™ä½ç²¾çµä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§åœ¨ä¸åŒæºé¡µé¢ä¹‹é—´å»ºç«‹è¿æ¥çš„æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>iframe src<span class="token operator">=</span><span class="token string">&quot;child.html&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;childFrame&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;400&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;300&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªåä¸ºchild.htmlçš„å°å®è—åµŒå¥—åˆ°äº†å¤§èˆå°ä¸Šã€‚è¿™å°±æ˜¯iframeçš„é­”æ³•æ‰€åœ¨ï¼</p><h3 id="_1-2-è®¤è¯†-postmessage" tabindex="-1"><a class="header-anchor" href="#_1-2-è®¤è¯†-postmessage" aria-hidden="true">#</a> 1.2 è®¤è¯† postMessage</h3><p>è€ŒpostMessageï¼Œå°±æ˜¯è¿™åœºæµªæ¼«é‚‚é€…çš„å·«å¸ˆã€‚ä»–æ˜¯HTML5å¼•å…¥çš„ä¸€ä½å¤§æ³•å¸ˆï¼Œå¯ä»¥åœ¨ä¸åŒæºçš„çª—å£ä¹‹é—´ä¼ é€’å®‰å…¨çš„æ¶ˆæ¯ã€‚è¿™å°±åƒæ˜¯ä»–ä¸ºè¿™å¯¹ç›¸äº²å¯¹è±¡æ‰“é€šäº†ä¸€æ¡é€šè®¯çš„é­”æ³•ä¹‹é—¨ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨çˆ¶é¡µé¢ä¸­</span>
<span class="token keyword">const</span> childFrame <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;childFrame&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
childFrame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">&#39;Hello from parent!&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œçˆ¶é¡µé¢é€šè¿‡postMessageå‘child.htmlå‘é€äº†ä¸€æ¡é—®å€™ã€‚è€Œè¿™æ¡æ¶ˆæ¯ç©¿è¶Šäº†ä¸åŒæºçš„è¾¹ç•Œï¼Œå®‰å…¨åœ°ä¼ é€’åˆ°äº†ç›®æ ‡é¡µé¢ã€‚</p>`,12),l=n("div",{class:"custom-container tip"},[n("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[n("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("circle",{cx:"12",cy:"12",r:"9"}),n("path",{d:"M12 8h.01"}),n("path",{d:"M11 12h1v4h1"})])]),n("p",{class:"custom-container-title"},"TIP"),n("p",null,[s("åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†iframeå’ŒpostMessageçš„æ¦‚å¿µï¼ŒåŒæ—¶ä½¿ç”¨ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å®ƒä»¬çš„åŸºæœ¬ç”¨æ³•ã€‚"),n("br"),s(" ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥ï¼Œè®¨è®ºå®ƒä»¬å¦‚ä½•ååŒå·¥ä½œï¼Œå®Œæˆè¿™åœºä¼ é€’æ•°æ®çš„èˆè¹ˆã€‚"),n("br"),s(" ä½ æ˜¯å¦å‡†å¤‡å¥½äº†ï¼ŸğŸ§")])],-1),i=a(`<h2 id="_2ã€iframe-å’Œ-postmessage-çš„åä¸½èˆè¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2ã€iframe-å’Œ-postmessage-çš„åä¸½èˆè¹ˆ" aria-hidden="true">#</a> 2ã€iframe å’Œ postMessage çš„åä¸½èˆè¹ˆ</h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„æ­æ¡£ iframe å’Œ postMessage å·²ç»ç›¸äº’è®¤è¯†ï¼Œæ˜¯æ—¶å€™çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åœ¨èˆå°ä¸Šåä¸½èµ·èˆçš„äº†ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨å®ƒä»¬çš„é»˜å¥‘é…åˆã€‚</p><h3 id="_2-1-ç›‘å¬å’Œå‘é€" tabindex="-1"><a class="header-anchor" href="#_2-1-ç›‘å¬å’Œå‘é€" aria-hidden="true">#</a> 2.1 ç›‘å¬å’Œå‘é€</h3><p>åœ¨è¿™åœºèˆè¹ˆä¸­ï¼Œä¸€æ–¹æ˜¯æ¶ˆæ¯çš„å‘é€è€…ï¼Œä¸€æ–¹æ˜¯æ¶ˆæ¯çš„æ¥æ”¶è€…ã€‚æˆ‘ä»¬éœ€è¦ç¡®ä¿è¿™ä¸¤ä½èˆè€…æ—¶åˆ»ä¿æŒå¬è§‰çµæ•ï¼Œä»¥ä¾¿åœ¨éŸ³ä¹å“èµ·æ—¶ï¼Œå‡†ç¡®åœ°å¼€å§‹æˆ–ç»“æŸä»–ä»¬çš„åŠ¨ä½œã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨çˆ¶é¡µé¢ä¸­</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataFromChild <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received data from child:&#39;</span><span class="token punctuation">,</span> dataFromChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å‘å­é¡µé¢å‘é€æ¶ˆæ¯</span>
<span class="token keyword">function</span> <span class="token function">sendMessageToChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">&#39;Hello from parent!&#39;</span><span class="token punctuation">;</span>
  childFrame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†åœ¨çˆ¶é¡µé¢ä¸­å¦‚ä½•ç›‘å¬å­é¡µé¢å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™å‘å­é¡µé¢å‘é€æ¶ˆæ¯ã€‚è¿™å°±æ˜¯æˆ‘ä»¬èˆå°ä¸Šçš„ä¸¤ä½èˆè€…å¦‚ä½•ç›¸äº’å‘¼åº”çš„æ–¹å¼ã€‚</p><h3 id="_2-2-åŒå‘é€šè®¯" tabindex="-1"><a class="header-anchor" href="#_2-2-åŒå‘é€šè®¯" aria-hidden="true">#</a> 2.2 åŒå‘é€šè®¯</h3><p>åœ¨è¿™åœºåä¸½çš„èˆè¹ˆä¸­ï¼Œä¸ä»…ä»…æ˜¯å•å‘çš„ä¼ é€’ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§åŒå‘çš„æ²Ÿé€šæ–¹å¼ã€‚è¿™å°±åƒæ˜¯åœ¨èˆè¹ˆä¸­ï¼Œæœ‰æ—¶ä½ ä¸»åŠ¨å¼•å¯¼ï¼Œæœ‰æ—¶ä½ éœ€è¦è·Ÿéšå¯¹æ–¹çš„æ­¥ä¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨å­é¡µé¢ä¸­</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">&#39;http://parent-origin.com&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataFromParent <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received data from parent:&#39;</span><span class="token punctuation">,</span> dataFromParent<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å‘çˆ¶é¡µé¢å‘é€å“åº”æ¶ˆæ¯</span>
    <span class="token keyword">const</span> responseMessage <span class="token operator">=</span> <span class="token string">&#39;Hello from child!&#39;</span><span class="token punctuation">;</span>
    event<span class="token punctuation">.</span>source<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>responseMessage<span class="token punctuation">,</span> <span class="token string">&#39;http://parent-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç å±•ç¤ºäº†åœ¨å­é¡µé¢ä¸­å¦‚ä½•ç›‘å¬çˆ¶é¡µé¢å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå‘çˆ¶é¡µé¢å‘é€å“åº”æ¶ˆæ¯ã€‚è¿™å°±æ˜¯ä¸¤ä½èˆè€…å¦‚ä½•é»˜å¥‘åœ°å®ŒæˆåŒå‘çš„èˆè¹ˆã€‚</p>`,10),r=n("div",{class:"custom-container tip"},[n("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[n("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("circle",{cx:"12",cy:"12",r:"9"}),n("path",{d:"M12 8h.01"}),n("path",{d:"M11 12h1v4h1"})])]),n("p",{class:"custom-container-title"},"TIP"),n("p",null,[s("åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†åœ¨ iframe å’Œ postMessage çš„å…±åŒä½œç”¨ä¸‹ï¼Œå¦‚ä½•å®ç°æ¶ˆæ¯çš„åŒå‘ä¼ é€’ã€‚"),n("br"),s(" è¿™å°±åƒæ˜¯ä¸€åœºè·¨åŸŸé€šè®¯çš„ä¼˜ç¾èˆè¹ˆï¼Œå½°æ˜¾äº†å®ƒä»¬é»˜å¥‘çš„èˆå°è¡¨æ¼”ã€‚"),n("br"),s(" æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¨è®ºä¸€äº›å…·ä½“çš„åº”ç”¨åœºæ™¯æˆ–è€…ç»§ç»­æ·±å…¥äº†è§£å®ƒä»¬çš„å·¥ä½œåŸç†ã€‚"),n("br"),s(" ä½ æƒ³è¦å“ªä¸ªæ–¹å‘å‘å±•ï¼ŸğŸ¤“")])],-1),u=a(`<h2 id="_3ã€è·¨è¶Šè¾¹ç•Œçš„æŒ‘æˆ˜" tabindex="-1"><a class="header-anchor" href="#_3ã€è·¨è¶Šè¾¹ç•Œçš„æŒ‘æˆ˜" aria-hidden="true">#</a> 3ã€è·¨è¶Šè¾¹ç•Œçš„æŒ‘æˆ˜</h2><p>è™½ç„¶æˆ‘ä»¬çš„ iframe å’Œ postMessage å·²ç»æ˜¯ä¸€å¯¹é»˜å¥‘çš„èˆä¼´ï¼Œä½†åœ¨éåŒæºçš„å¤§èˆå°ä¸Šï¼Œå®ƒä»¬ä»ç„¶éœ€è¦é¢å¯¹ä¸€äº›ç‰¹æ®Šçš„è€ƒéªŒã€‚<br> åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨åœ¨éåŒæºç¯å¢ƒä¸‹æ•°æ®ä¼ é€’çš„ä¸€äº›æŒ‘æˆ˜å’Œè§£å†³æ–¹æ¡ˆã€‚</p><h3 id="_3-1-å®‰å…¨ä¹‹çº¦-åŒæºç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_3-1-å®‰å…¨ä¹‹çº¦-åŒæºç­–ç•¥" aria-hidden="true">#</a> 3.1 å®‰å…¨ä¹‹çº¦ï¼šåŒæºç­–ç•¥</h3><p>åœ¨Webå¼€å‘çš„èˆå°ä¸Šï¼ŒåŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰æ‰®æ¼”ç€ä¸€ä½é‡è¦çš„é—¨å«ï¼Œç¡®ä¿ä¸åŒæºçš„ç½‘é¡µä¹‹é—´çš„å®‰å…¨æ€§ã€‚è¿™ä¸ªç­–ç•¥åŸºäºä¸€ä¸ªç®€å•è€Œæœ‰åŠ›çš„åŸåˆ™ï¼šä¸€ä¸ªç½‘é¡µåªèƒ½ä»ç›¸åŒåè®®ã€ä¸»æœºå’Œç«¯å£åŠ è½½å¦ä¸€ä¸ªç½‘é¡µçš„èµ„æºã€‚è¿™æ„å‘³ç€å¦‚æœä¸¤ä¸ªç½‘é¡µçš„åè®®ã€ä¸»æœºæˆ–ç«¯å£ä»»æ„ä¸€ä¸ªä¸åŒï¼Œå®ƒä»¬å°±è¢«è®¤ä¸ºæ˜¯ä¸åŒæºçš„ã€‚</p><p>åŒæºç­–ç•¥çš„å­˜åœ¨æ˜¯ä¸ºäº†é˜²æ­¢æ¶æ„ç½‘é¡µé€šè¿‡ä¸€äº›éšè”½çš„æ‰‹æ®µè·å–å…¶ä»–ç½‘é¡µçš„æ•æ„Ÿä¿¡æ¯ã€‚ç„¶è€Œï¼Œåœ¨ç°å®çš„Webå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨ä¸åŒæºçš„ç½‘é¡µä¹‹é—´è¿›è¡Œä¸€äº›åˆç†çš„äº¤äº’ï¼Œè¿™å°±æ˜¯ iframe å’Œ postMessage çš„èˆå°ç™»åœºçš„åœ°æ–¹ã€‚</p><details class="custom-container details"><summary class="custom-container-title">åŒæºç­–ç•¥çš„é™åˆ¶</summary><p>åŒæºç­–ç•¥é™åˆ¶äº†ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„æ“ä½œï¼š<br> 1ã€Cookieã€LocalStorage å’Œ IndexDB ç­‰å­˜å‚¨æ€§èµ„æºï¼š ä¸åŒæºçš„é¡µé¢æ— æ³•è®¿é—®å½¼æ­¤çš„æœ¬åœ°å­˜å‚¨èµ„æºï¼Œä»¥ç¡®ä¿ç”¨æˆ·æ•æ„Ÿä¿¡æ¯çš„å®‰å…¨ã€‚ <br> 2ã€DOMï¼š ä¸åŒæºçš„é¡µé¢æ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹çš„ DOM ç»“æ„ï¼Œä»¥é˜²æ­¢æ¶æ„é¡µé¢ç¯¡æ”¹å…¶ä»–é¡µé¢çš„æ˜¾ç¤ºã€‚ <br> 3ã€AJAX è¯·æ±‚ï¼š ä¸åŒæºçš„é¡µé¢æ— æ³•é€šè¿‡æ™®é€šçš„ AJAX è¯·æ±‚è·å–å¯¹æ–¹çš„æ•°æ®ï¼Œä»¥ä¿æŠ¤ç”¨æˆ·çš„éšç§ã€‚</p></details><h3 id="_3-2-å§œå¤ªå…¬é’“é±¼-å®‰å…¨çš„æ¶ˆæ¯éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_3-2-å§œå¤ªå…¬é’“é±¼-å®‰å…¨çš„æ¶ˆæ¯éªŒè¯" aria-hidden="true">#</a> 3.2 å§œå¤ªå…¬é’“é±¼ï¼šå®‰å…¨çš„æ¶ˆæ¯éªŒè¯</h3><p>åœ¨éåŒæºçš„ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°å¿ƒç¿¼ç¿¼åœ°éªŒè¯æ¶ˆæ¯çš„æ¥æºã€‚<br> å°±åƒæ˜¯å§œå¤ªå…¬é’“é±¼ï¼Œæˆ‘ä»¬å¸Œæœ›åªæœ‰é‚£äº›çœŸæ­£æ„¿æ„ä¸Šé’©çš„é±¼å„¿æ‰èƒ½å¤Ÿè¢«æ¥çº³ã€‚<br> é€šè¿‡æ£€æŸ¥æ¶ˆæ¯çš„æ¥æºï¼ˆevent.originï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿åªæœ‰åˆæ³•çš„æ¶ˆæ¯æ‰èƒ½å¤Ÿè¢«å¤„ç†ã€‚</p><p>åœ¨åŒæºç­–ç•¥çš„é™åˆ¶ä¸‹ï¼Œiframe å’Œ postMessage æä¾›äº†ä¸€ç§è·¨è¶ŠåŒæºé™åˆ¶çš„æ–¹æ³•ã€‚<br> é€šè¿‡åœ¨ä¸€ä¸ªé¡µé¢ä¸­åµŒå¥—å¦ä¸€ä¸ªé¡µé¢ï¼Œç„¶åä½¿ç”¨ postMessage è¿›è¡Œå®‰å…¨çš„æ¶ˆæ¯ä¼ é€’ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒæºçš„é¡µé¢ä¹‹é—´å»ºç«‹èµ·é€šä¿¡çš„æ¡¥æ¢ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨çˆ¶é¡µé¢ä¸­</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¤„ç†æ¥è‡ªåˆæ³•æºçš„æ¶ˆæ¯</span>
    <span class="token keyword">const</span> dataFromChild <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received data from child:&#39;</span><span class="token punctuation">,</span> dataFromChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æ£€æŸ¥ event.originï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿åªå¤„ç†æ¥è‡ªåˆæ³•æºçš„æ¶ˆæ¯ï¼Œä»è€Œç»´æŠ¤äº†åŒæºç­–ç•¥çš„å®‰å…¨æ€§ã€‚<br> è¿™å°±æ˜¯ postMessage åœ¨åŒæºç­–ç•¥ä¸‹å®‰å…¨ä¼ é€’æ¶ˆæ¯çš„æœºåˆ¶ã€‚</p>`,11),d=n("div",{class:"custom-container tip"},[n("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[n("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("circle",{cx:"12",cy:"12",r:"9"}),n("path",{d:"M12 8h.01"}),n("path",{d:"M11 12h1v4h1"})])]),n("p",{class:"custom-container-title"},"TIP"),n("p",null,[s("æ€»çš„æ¥è¯´ï¼ŒåŒæºç­–ç•¥æ˜¯Webå®‰å…¨çš„åŸºçŸ³ï¼Œè€Œ iframe å’Œ postMessage åˆ™ä¸ºæˆ‘ä»¬æä¾›äº†åœ¨åŒæºé™åˆ¶ä¸‹è¿›è¡Œè·¨åŸŸé€šä¿¡çš„ä¸€ç§ä¼˜é›…è§£å†³æ–¹æ¡ˆã€‚"),n("br"),s(" åœ¨è¿™åœºèˆå°ä¸Šï¼Œå®ƒä»¬å…±åŒæ„å»ºèµ·äº†ä¸€åº§å®‰å…¨ä¹‹æ¡¥ï¼Œä½¿å¾—ä¸åŒæºçš„ç½‘é¡µå¯ä»¥å’Œè°å…±èˆï¼Œè€Œæ— éœ€æ‹…å¿ƒä¿¡æ¯æ³„éœ²çš„é£é™©ã€‚")])],-1),k=n("h2",{id:"_4ã€å®é™…åº”ç”¨åœºæ™¯",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_4ã€å®é™…åº”ç”¨åœºæ™¯","aria-hidden":"true"},"#"),s(" 4ã€å®é™…åº”ç”¨åœºæ™¯")],-1),v=n("p",null,[s("åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥äº†è§£äº† iframe å’Œ postMessage åœ¨éåŒæºç¯å¢ƒä¸‹çš„æ•°æ®ä¼ é€’ã€‚"),n("br"),s(" è®©æˆ‘ä»¬å°†è¿™äº›ç†è®ºçŸ¥è¯†åº”ç”¨åˆ°å®é™…åœºæ™¯ä¸­ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åœ¨çœŸå®çš„é¡¹ç›®ä¸­å‘æŒ¥ä½œç”¨çš„ã€‚")],-1),m=n("h3",{id:"_4-1-è·¨æ–‡æ¡£æ•°æ®ä¼ é€’çš„å®é™…åº”ç”¨",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_4-1-è·¨æ–‡æ¡£æ•°æ®ä¼ é€’çš„å®é™…åº”ç”¨","aria-hidden":"true"},"#"),s(" 4.1 è·¨æ–‡æ¡£æ•°æ®ä¼ é€’çš„å®é™…åº”ç”¨")],-1),g=n("h4",null,"åœºæ™¯ä¸€ï¼šå•ç‚¹ç™»å½•ï¼ˆSingle Sign-Onï¼‰",-1),h=a(`<p>å®ç°æ­¥éª¤ï¼š</p><ol><li>ç”¨æˆ·åœ¨é—¨æˆ·ç½‘ç«™ç™»å½•åï¼Œç”Ÿæˆä¸€ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰ã€‚<br></li><li>å°†ä»¤ç‰Œä¼ é€’ç»™å­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿå°†ä»¤ç‰Œå­˜å‚¨åœ¨æœ¬åœ°ã€‚<br></li><li>åœ¨å­ç³»ç»Ÿä¸­åµŒå¥—é—¨æˆ·ç½‘ç«™çš„ iframeï¼Œå¹¶ä½¿ç”¨ postMessage å°†ä»¤ç‰Œä¼ é€’ç»™é—¨æˆ·ç½‘ç«™ã€‚<br> é—¨æˆ·ç½‘ç«™æ¥æ”¶åˆ°ä»¤ç‰Œåï¼ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ï¼Œä»è€Œå®ç°ç”¨æˆ·åœ¨å­ç³»ç»Ÿä¸­çš„å•ç‚¹ç™»å½•ã€‚</li></ol><details class="custom-container details"><summary class="custom-container-title">DETAILS</summary><p>é—¨æˆ·ç½‘ç«™ï¼ˆParentï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> parent<span class="token punctuation">.</span>html <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Parent Site<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Parent Site<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>button onclick<span class="token operator">=</span><span class="token string">&quot;login()&quot;</span><span class="token operator">&gt;</span>Login<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">&quot;childFrame&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;child.html&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;600&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;400&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åœ¨ç™»å½•åç”Ÿæˆä»¤ç‰Œï¼ˆè¿™é‡Œç®€åŒ–ä¸ºéšæœºç”Ÿæˆï¼‰</span>
      <span class="token keyword">const</span> token <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token comment">// è·å–å­ç³»ç»Ÿçš„ iframe</span>
      <span class="token keyword">const</span> childFrame <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;childFrame&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// å‘å­ç³»ç»Ÿå‘é€ä»¤ç‰Œ</span>
      childFrame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> token <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­ç³»ç»Ÿï¼ˆChildï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> child<span class="token punctuation">.</span>html <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Child System<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Child System<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Status<span class="token operator">:</span> Not Logged In<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token comment">// ç›‘å¬æ¥è‡ªé—¨æˆ·ç½‘ç«™çš„æ¶ˆæ¯</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">&#39;http://parent-origin.com&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;login&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// åœ¨å­ç³»ç»Ÿä¸­å¤„ç†ç™»å½•é€»è¾‘</span>
          <span class="token comment">// è¿™é‡Œç®€å•åœ°æ›´æ–°çŠ¶æ€ï¼Œå®é™…åº”ç”¨ä¸­éœ€è¦è¿›è¡Œç”¨æˆ·éªŒè¯ç­‰æ“ä½œ</span>
          document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Status: Logged In with Token - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>data<span class="token punctuation">.</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ç”¨æˆ·åœ¨é—¨æˆ·ç½‘ç«™ä¸­ç‚¹å‡»ç™»å½•æŒ‰é’®æ—¶ï¼Œé—¨æˆ·ç½‘ç«™ç”Ÿæˆäº†ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œå¹¶é€šè¿‡ postMessage å‘å­ç³»ç»Ÿä¼ é€’äº†ç™»å½•æ¶ˆæ¯ã€‚å­ç³»ç»Ÿç›‘å¬æ¥è‡ªé—¨æˆ·ç½‘ç«™çš„æ¶ˆæ¯ï¼Œåœ¨æ”¶åˆ°ç™»å½•æ¶ˆæ¯åæ›´æ–°äº†çŠ¶æ€ã€‚<br> è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„ç¤ºä¾‹ï¼Œå®é™…ä¸Šï¼Œä½ å¯èƒ½éœ€è¦æ›´å¤æ‚çš„ç”¨æˆ·éªŒè¯é€»è¾‘ã€‚</p></details><h4>åœºæ™¯äºŒï¼šåµŒå¥—ç¬¬ä¸‰æ–¹å†…å®¹</h4>`,4),b=a(`<p>å®ç°æ­¥éª¤ï¼š</p><ol><li>ç”¨æˆ·åœ¨åšå®¢å¹³å°è¾“å…¥å…¶ä»–ç”¨æˆ·çš„åšå®¢æ–‡ç« åœ°å€ã€‚</li><li>åšå®¢å¹³å°é€šè¿‡ iframe åµŒå¥—ç¬¬ä¸‰æ–¹åšå®¢æ–‡ç« ï¼Œå¹¶ä½¿ç”¨ postMessage å‘åµŒå¥—çš„é¡µé¢ä¼ é€’ä¸€äº›é…ç½®ä¿¡æ¯ã€‚</li><li>ç¬¬ä¸‰æ–¹åšå®¢æ–‡ç« é¡µé¢æ¥æ”¶åˆ°é…ç½®ä¿¡æ¯åï¼Œæ ¹æ®é…ç½®è¿›è¡Œç›¸åº”çš„æ˜¾ç¤ºè°ƒæ•´ï¼Œä»¥é€‚åº”åœ¨åšå®¢å¹³å°ä¸­çš„å±•ç¤ºè¦æ±‚ã€‚</li></ol><details class="custom-container details"><summary class="custom-container-title">DETAILS</summary><p>åšå®¢å¹³å°ï¼ˆBlog Platformï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> blog<span class="token operator">-</span>platform<span class="token punctuation">.</span>html <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Blog Platform<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Blog Platform<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">&quot;myIframe&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;blog.html&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;300&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;600&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;DOMContentLoaded&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token string">&#39;1111111111&#39;</span>
      <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myIframe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">token</span><span class="token operator">:</span>token <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;blog.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬ä¸‰æ–¹åšå®¢æ–‡ç« ï¼ˆThird-party Blogï¼‰ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> third<span class="token operator">-</span>party<span class="token operator">-</span>blog<span class="token punctuation">.</span>html <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Third<span class="token operator">-</span>party Blog<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Third<span class="token operator">-</span>party Blog<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>This is a fascinating blog post<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> message <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>message <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è¿™é‡Œå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œä¸€äº›åŠ¨æ€è°ƒæ•´ï¼Œä»¥é€‚åº”åœ¨åšå®¢å¹³å°ä¸­çš„å±•ç¤ºè¦æ±‚</span>
          <span class="token punctuation">}</span>

      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”¨æˆ·åœ¨åšå®¢å¹³å°ä¸­è¾“å…¥äº†å…¶ä»–ç”¨æˆ·çš„åšå®¢æ–‡ç« åœ°å€ï¼Œåšå®¢å¹³å°é€šè¿‡åˆ›å»º iframe å…ƒç´ å¹¶è®¾ç½®å…¶ src å±æ€§æ¥åµŒå¥—ç¬¬ä¸‰æ–¹åšå®¢æ–‡ç« ã€‚è¿™æ ·ï¼Œç¬¬ä¸‰æ–¹åšå®¢æ–‡ç« å°±å¯ä»¥åœ¨åšå®¢å¹³å°ä¸­å±•ç¤ºå‡ºæ¥ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦æ›´å¤šçš„é…ç½®å’Œæ ·å¼çš„è°ƒæ•´ï¼Œä»¥ç¡®ä¿åµŒå¥—çš„å†…å®¹åœ¨åšå®¢å¹³å°ä¸­è‰¯å¥½åœ°æ˜¾ç¤ºã€‚</p></details><h3 id="_4-2-å®é™…é¡¹ç›®ä¸­çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_4-2-å®é™…é¡¹ç›®ä¸­çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> 4.2 å®é™…é¡¹ç›®ä¸­çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ</h3><h4>æŒ‘æˆ˜ä¸€ï¼šå®‰å…¨æ€§é—®é¢˜</h4>`,5),f=n("h4",null,"æŒ‘æˆ˜äºŒï¼šæ€§èƒ½é—®é¢˜",-1),w=n("h4",null,"è§£å†³æ–¹æ¡ˆï¼šç»†è‡´å…¥å¾®çš„æ§åˆ¶",-1),_=a(`<details class="custom-container details"><summary class="custom-container-title">è§£å†³æ–¹æ¡ˆä¸€ï¼šå®‰å…¨æ€§é—®é¢˜</summary><p>åœ¨æ¶ˆæ¯çš„æ¥æ”¶æ–¹è¿›è¡Œå®‰å…¨éªŒè¯ï¼ŒåŒ…æ‹¬éªŒè¯æ¶ˆæ¯çš„æ¥æº (event.origin) å’Œæ¶ˆæ¯çš„å†…å®¹ã€‚åªæœ‰å½“æ¶ˆæ¯æ¥è‡ªå¯ä¿¡ä»»çš„æºå¹¶åŒ…å«å—ä¿¡ä»»çš„æ•°æ®æ—¶ï¼Œæ‰åº”è¯¥å¤„ç†è¿™äº›æ¶ˆæ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// å­ç³»ç»Ÿä¸­çš„æ¶ˆæ¯éªŒè¯</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">&#39;http://parent-origin.com&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

    <span class="token comment">// è¿›è¡Œæ›´è¯¦ç»†çš„å®‰å…¨éªŒè¯ï¼Œä¾‹å¦‚éªŒè¯ token çš„æœ‰æ•ˆæ€§ç­‰</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;login&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isValidToken</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¤„ç†ç™»å½•é€»è¾‘</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="custom-container details"><summary class="custom-container-title">è§£å†³æ–¹æ¡ˆäºŒï¼šæ€§èƒ½é—®é¢˜</summary><p>é™åˆ¶æ¶ˆæ¯çš„ä¼ é€’é¢‘ç‡ï¼Œç¡®ä¿åªæœ‰å¿…è¦çš„ä¿¡æ¯è¢«ä¼ é€’ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œé¿å…é‡å¤è·å–ç›¸åŒçš„ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// é—¨æˆ·ç½‘ç«™ä¸­çš„æ¶ˆæ¯å‘é€</span>
<span class="token keyword">function</span> <span class="token function">sendTokenToChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token function">getTokenFromLocalStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// åªæœ‰åœ¨ token ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹æ‰å‘é€æ¶ˆæ¯</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    childFrame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> token <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ç»†è‡´å…¥å¾®åœ°æ§åˆ¶æ¶ˆæ¯çš„æ¥æºã€å†…å®¹å’Œé¢‘ç‡ï¼Œå¯ä»¥åœ¨å®é™…é¡¹ç›®ä¸­å–å¾—è‰¯å¥½çš„æ€§èƒ½è¡¨ç°ã€‚</p></details>`,2),y=n("div",{class:"custom-container tip"},[n("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[n("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("circle",{cx:"12",cy:"12",r:"9"}),n("path",{d:"M12 8h.01"}),n("path",{d:"M11 12h1v4h1"})])]),n("p",{class:"custom-container-title"},"TIP"),n("p",null,[s("åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°† iframe å’Œ postMessage åº”ç”¨åˆ°å®é™…é¡¹ç›®åœºæ™¯ä¸­ï¼Œè®¨è®ºäº†ä¸€äº›å¸¸è§çš„åº”ç”¨æ¡ˆä¾‹ï¼Œå¹¶æå‡ºäº†åœ¨å®é™…é¡¹ç›®ä¸­å¯èƒ½é¢ä¸´çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆã€‚"),n("br"),s(" é€šè¿‡è¿™äº›å®é™…æ¡ˆä¾‹ï¼Œæˆ‘ä»¬èƒ½æ›´æ·±å…¥åœ°ç†è§£è¿™å¯¹é»˜å¥‘çš„èˆä¼´æ˜¯å¦‚ä½•åœ¨å®æˆ˜ä¸­å‘æŒ¥ä½œç”¨çš„ã€‚"),n("br"),s(" æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ¢è®¨ä¸€äº›é«˜çº§çš„ä¸»é¢˜ï¼Œæˆ–è€…æ€»ç»“è¿™æ¬¡æ—…ç¨‹çš„æ‰€å­¦æ‰€æ„Ÿã€‚"),n("br"),s(" ä½ æœ‰å…¶ä»–ç‰¹åˆ«å…³æ³¨çš„æ–¹å‘å—ï¼Ÿ")])],-1),x=a(`<h2 id="_5ã€é«˜çº§ä¸»é¢˜" tabindex="-1"><a class="header-anchor" href="#_5ã€é«˜çº§ä¸»é¢˜" aria-hidden="true">#</a> 5ã€é«˜çº§ä¸»é¢˜</h2><p>åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶ä¸€äº›ä¸ iframe å’Œ postMessage ç›¸å…³çš„é«˜çº§ä¸»é¢˜ï¼Œä»¥åŠå®ƒä»¬åœ¨å®é™…å¼€å‘ä¸­çš„æ›´æ·±å±‚æ¬¡çš„åº”ç”¨ã€‚</p><h3 id="_5-1-è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„å®‰å…¨æ€§å¢å¼º" tabindex="-1"><a class="header-anchor" href="#_5-1-è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„å®‰å…¨æ€§å¢å¼º" aria-hidden="true">#</a> 5.1 è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„å®‰å…¨æ€§å¢å¼º</h3><ol><li>æ¶ˆæ¯æºçš„éªŒè¯<br> åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¼ºè°ƒäº†éªŒè¯æ¶ˆæ¯æ¥æºçš„é‡è¦æ€§ã€‚ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé¢ä¸´æ›´ä¸ºå¤æ‚çš„æƒ…å†µã€‚<br> ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¤„ç†å¤šä¸ªå­ç³»ç»Ÿï¼Œæ¯ä¸ªå­ç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªä¸åŒçš„æºã€‚ä¸ºäº†æé«˜å®‰å…¨æ€§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ›´ä¸ºçµæ´»çš„æ–¹å¼éªŒè¯æ¶ˆæ¯æ¥æºï¼Œè€Œä¸ä»…ä»…æ˜¯é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼æ£€æŸ¥ &quot;<strong>event.origin</strong>&quot;ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨çˆ¶é¡µé¢ä¸­</span>
<span class="token keyword">const</span> trustedOrigins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;http://child1-origin.com&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;http://child2-origin.com&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>trustedOrigins<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// å¤„ç†æ¥è‡ªåˆæ³•æºçš„æ¶ˆæ¯</span>
   <span class="token keyword">const</span> dataFromChild <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received data from child:&#39;</span><span class="token punctuation">,</span> dataFromChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ä½¿ç”¨å®‰å…¨é€šä¿¡é€šé“<br> åœ¨ä¸€äº›æ•æ„Ÿçš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ›´é«˜çº§çš„å®‰å…¨æªæ–½ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨åŠ å¯†é€šä¿¡æ¥ç¡®ä¿æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„æœºå¯†æ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ HTTPS åè®®ä»¥åŠåŠ å¯†ç®—æ³•æ¥å®ç°ã€‚</li></ol><h3 id="_5-2-è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_5-2-è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„æ€§èƒ½ä¼˜åŒ–" aria-hidden="true">#</a> 5.2 è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„æ€§èƒ½ä¼˜åŒ–</h3><ol><li>æ‡’åŠ è½½å’ŒæŒ‰éœ€åŠ è½½<br> ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨æ‡’åŠ è½½å’ŒæŒ‰éœ€åŠ è½½çš„ç­–ç•¥ã€‚ä¸å¿…åœ¨é¡µé¢åŠ è½½æ—¶å°±å°†æ‰€æœ‰ iframe åŠ è½½è¿›æ¥ï¼Œè€Œæ˜¯åœ¨éœ€è¦æ—¶å†è¿›è¡ŒåŠ è½½ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åŠ¨æ€åˆ›å»º iframe</span>
<span class="token keyword">function</span> <span class="token function">loadChildFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> childFrame <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;iframe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">&#39;myIframe&#39;</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token string">&#39;2px&#39;</span><span class="token punctuation">;</span>
  iframe<span class="token punctuation">.</span>scrolling<span class="token operator">=</span><span class="token string">&quot;no&quot;</span> 
  iframe<span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token string">&#39;lazy&#39;</span><span class="token punctuation">;</span>
  childFrame<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&#39;child.html&#39;</span><span class="token punctuation">;</span>

  <span class="token comment">// å°† iframe æ’å…¥åˆ°é¡µé¢ä¸­</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>childFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ä¼˜åŒ–æ¶ˆæ¯çš„ä¼ é€’é¢‘ç‡<br> åˆç†åœ°æ§åˆ¶æ¶ˆæ¯çš„ä¼ é€’é¢‘ç‡æ˜¯æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›ç¼“å­˜ç­–ç•¥ï¼Œé¿å…ä¸å¿…è¦çš„æ•°æ®ä¼ é€’ã€‚</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨çˆ¶é¡µé¢ä¸­</span>
<span class="token keyword">let</span> lastData <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sendDataToChild</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åªæœ‰åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰å‘é€æ¶ˆæ¯</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>lastData<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    childFrame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&#39;http://child-origin.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lastData <span class="token operator">=</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),q=n("div",{class:"custom-container tip"},[n("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[n("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[n("circle",{cx:"12",cy:"12",r:"9"}),n("path",{d:"M12 8h.01"}),n("path",{d:"M11 12h1v4h1"})])]),n("p",{class:"custom-container-title"},"TIP"),n("p",null,[s("åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†ä¸€äº›é«˜çº§ä¸»é¢˜ï¼ŒåŒ…æ‹¬å®‰å…¨æ€§å¢å¼ºã€æ€§èƒ½ä¼˜åŒ–ã€‚è¿™äº›ä¸»é¢˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°åº”å¯¹å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼Œå¹¶ç¡®ä¿è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’çš„å¯é æ€§å’Œå®‰å…¨æ€§ã€‚"),n("br"),s(" å¦‚æœä½ æœ‰å…¶ä»–å…³æ³¨çš„ä¸»é¢˜ï¼Œæˆ–è€…å¸Œæœ›æ›´æ·±å…¥äº†è§£å…¶ä¸­çš„æŸä¸ªæ–¹é¢ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼")])],-1),M=n("h2",{id:"ç»“ç¼˜",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ç»“ç¼˜","aria-hidden":"true"},"#"),s(" ç»“ç¼˜")],-1),j=n("p",null,"åœ¨è¿™ä¸ªä»£ç çš„æ—¶ç©ºä¸­ï¼Œæˆ‘ä»¬é‚‚é€…äº† iframe å’Œ postMessageï¼Œå®ƒä»¬å¦‚åŒç¼–ç¨‹ä¸–ç•Œä¸­çš„ä¸€å¯¹æµªæ¼«æƒ…ä¾£ï¼Œé»˜å¥‘æ— é—´ï¼Œå…±èˆäºæµè§ˆå™¨çš„å¤œç©ºã€‚",-1),T=n("p",null,"åœ¨åŒæºçš„èŠ±æµ·ä¸­ï¼Œæˆ‘ä»¬ç›®ç¹äº†å®ƒä»¬çš„ç¼ ç»µï¼Œä»ä¸€ä¸ªæ¨¡å—ä¼ é€’åˆ°å¦ä¸€ä¸ªæ¨¡å—ï¼Œä»¿ä½›ä»£ç é—´çš„ç§˜å¯†å‘Šç™½ï¼Œè®©æ•´ä¸ªWebé¡µé¢å˜æˆäº†ä¸€ä¸ªå¥‡å¦™çš„èˆå°ã€‚",-1),F=n("p",null,"å°±åƒä¸€ä¸ªæ¨¡å—åœ¨å¤œæ™šè½»è½»åœ°å¯¹å¦ä¸€ä¸ªæ¨¡å—è€³è¯­ä¸€æ ·ï¼Œå®ƒä»¬ç”¨ postMessage ä¼ é€’ç€æ€å¿µï¼Œå®ç°ç€é¡µé¢é—´çš„æ¸©é¦¨äº¤æµã€‚",-1),C=n("p",null,"åœ¨è¿™åœºä»£ç çš„é‚‚é€…ä¸­ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•å·§å¦™åœ°è¯‰è¯´å¿ƒæ„ï¼Œç”¨åµŒå¥—çš„é­”æ³•åˆ›é€ å¥‡è¿¹ï¼Œå…±åŒèˆªå‘æœªçŸ¥çš„å†’é™©ã€‚",-1),S=n("p",null,"æœªæ¥ï¼Œæˆ–è®¸è¿™å¯¹æµªæ¼«æ­æ¡£ä¼šç»§ç»­åœ¨Webçš„æ˜Ÿç©ºä¸­å¾œå¾‰ï¼Œä¸å…¶ä»–æŠ€æœ¯ç›¸é‡ï¼Œå…±ç»‡å‡ºæ›´ä¸ºç¾ä¸½çš„å‰ç«¯æ•…äº‹ã€‚",-1),E=n("p",null,"è®©æˆ‘ä»¬ä¸€èµ·æ€€æ£ç€å¯¹ä»£ç æµªæ¼«çš„æ†§æ†¬ï¼Œç»§ç»­è¿½å¯»é‚£ç‰‡å±äºæˆ‘ä»¬çš„Webå¼€å‘çš„æ˜Ÿæµ·ã€‚",-1);function P(B,L){return p(),e("div",null,[c,l,i,r,u,d,k,v,m,g,s(" å‡è®¾æœ‰ä¸€ä¸ªé—¨æˆ·ç½‘ç«™ï¼Œç”¨æˆ·éœ€è¦åœ¨è¿™ä¸ªé—¨æˆ·ç½‘ç«™ä¸Šç™»å½•åï¼Œèƒ½å¤Ÿè®¿é—®å…¶ä»–ä¸åŒæºçš„å­ç³»ç»Ÿï¼Œè€Œæ— éœ€å†æ¬¡ç™»å½•ã€‚é€šè¿‡ä½¿ç”¨ iframe å’Œ postMessageï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å•ç‚¹ç™»å½•çš„æ•ˆæœã€‚ "),h,s(" å‡è®¾æœ‰ä¸€ä¸ªåšå®¢å¹³å°ï¼Œç”¨æˆ·å¯ä»¥åœ¨è‡ªå·±çš„åšå®¢ä¸­åµŒå¥—å…¶ä»–ç”¨æˆ·çš„åšå®¢æ–‡ç« ã€‚é€šè¿‡ä½¿ç”¨ iframe å’Œ postMessageï¼Œæˆ‘ä»¬å¯ä»¥å®ç°åœ¨åšå®¢å¹³å°ä¸­åµŒå¥—ç¬¬ä¸‰æ–¹å†…å®¹çš„åŠŸèƒ½ã€‚ "),b,s(" åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå®‰å…¨æ€§å§‹ç»ˆæ˜¯é¦–è¦ä»»åŠ¡ã€‚ä¸ºäº†é˜²èŒƒ XSS æ”»å‡»ç­‰å¨èƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¶ˆæ¯ä¼ é€’çš„è¿‡ç¨‹ä¸­åšå¥½æ¶ˆæ¯çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œç¡®ä¿åªæœ‰åˆæ³•çš„æ¶ˆæ¯å¾—ä»¥å¤„ç†ã€‚ "),f,s(" åœ¨ä¸€äº›å¤æ‚çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œé¢‘ç¹çš„æ•°æ®ä¼ é€’å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›ç¼“å­˜ç­–ç•¥ï¼Œé¿å…ä¸å¿…è¦çš„æ•°æ®ä¼ é€’ã€‚ "),w,s(" é€šè¿‡ç»†è‡´å…¥å¾®åœ°æ§åˆ¶æ¶ˆæ¯çš„æ¥æºã€å†…å®¹å’Œé¢‘ç‡ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³å®‰å…¨æ€§å’Œæ€§èƒ½é—®é¢˜ã€‚åˆç†åœ°ä½¿ç”¨æ¶ˆæ¯ä¼ é€’ï¼Œå¯ä»¥åœ¨å®é™…é¡¹ç›®ä¸­å–å¾—è‰¯å¥½çš„æ•ˆæœã€‚ "),_,y,x,q,M,j,T,F,C,S,E])}const D=t(o,[["render",P],["__file","index.html.vue"]]);export{D as default};
